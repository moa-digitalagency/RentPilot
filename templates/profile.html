
<!--
* Nom de l'application : RentPilot
* Description : User profile page.
* Produit de : MOA Digital Agency, www.myoneart.com
* Fait par : Aisance KALONJI, www.aisancekalonji.com
* Auditer par : La CyberConfiance, www.cyberconfiance.com
-->
{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Mon Profil</h1>

        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Informations Personnelles</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-500">Email</label>
                    <p class="text-gray-900 font-medium">{{ current_user.email }}</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-500">Role</label>
                    <p class="text-gray-900 font-medium">{{ current_user.role.value }}</p>
                </div>
            </div>
        </div>

        <hr class="my-8 border-gray-200">

        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Vérification d'Identité</h2>

            {% if current_user.is_identity_verified %}
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 flex items-center mb-6">
                    <svg class="w-6 h-6 text-green-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                    <div>
                        <p class="text-green-800 font-bold">Identité Vérifiée</p>
                        <p class="text-sm text-green-600">Votre pièce d'identité a été validée.</p>
                        {% if current_user.identity_card_url %}
                            <a href="{{ current_user.identity_card_url }}" target="_blank" class="text-sm text-green-700 underline mt-1 inline-block">Voir le document</a>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <p class="text-yellow-800 font-bold mb-2">Statut: Non Vérifié</p>
                    <p class="text-sm text-yellow-700">Veuillez télécharger une copie de votre pièce d'identité (Carte d'identité ou Passeport) pour valider votre profil. Ce document sera visible par vos bailleurs.</p>
                </div>

                <form action="{{ url_for('main.verify_identity') }}" method="POST" enctype="multipart/form-data" class="space-y-4">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Télécharger une pièce d'identité</label>
                        <input type="file" name="identity_card" accept="image/*,.pdf" class="block w-full text-sm text-gray-500
                            file:mr-4 file:py-2 file:px-4
                            file:rounded-full file:border-0
                            file:text-sm file:font-semibold
                            file:bg-indigo-50 file:text-indigo-700
                            hover:file:bg-indigo-100
                        " required>
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-200">
                        Envoyer pour validation
                    </button>
                </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
